<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title>Javascript 호출 스택(=Call Stack) | Youmekko</title><meta name="description" content="Javascript 호출 스택(=Call Stack) - Youme Choi"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/theme.css"><link rel="search" type="application/opensearchdescription+xml" href="/atom.xml" title="Youmekko"><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="Youmekko" type="application/atom+xml">
</head><body><div class="wrap"><header><h1 class="branding"><a href="/" title="Youmekko">Youmekko</a></h1><ul class="nav nav-list"><li class="nav-list-item"><a class="nav-list-link" href="/" target="_self">HOME</a></li><li class="nav-list-item"><a class="nav-list-link" href="/archives" target="_self">ARCHIVES</a></li><li class="nav-list-item"><a class="nav-list-link" href="https://github.com/youmekko" target="_blank">GITHUB</a></li><li class="nav-list-item"><a class="nav-list-link" href="/atom.xml" target="_self">RSS</a></li><li class="nav-list-item"><a class="nav-list-link" href="/about" target="_self">ABOUT</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Javascript 호출 스택(=Call Stack)</h1><div class="post-info"><a></a>2019-04-11</div><div class="post-content"><p>참고</p>
<p><a href="https://blog.sessionstack.com/how-does-javascript-actually-work-part-1-b0bacc073cf" target="_blank" rel="noopener">https://blog.sessionstack.com/how-does-javascript-actually-work-part-1-b0bacc073cf</a></p>
<p><a href="https://joshua1988.github.io/web-development/translation/javascript/how-js-works-inside-engine/" target="_blank" rel="noopener">https://joshua1988.github.io/web-development/translation/javascript/how-js-works-inside-engine/</a></p>
<p><a href="https://engineering.huiseoul.com/%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8%EB%8A%94-%EC%96%B4%EB%96%BB%EA%B2%8C-%EC%9E%91%EB%8F%99%ED%95%98%EB%8A%94%EA%B0%80-%EC%97%94%EC%A7%84-%EB%9F%B0%ED%83%80%EC%9E%84-%EC%BD%9C%EC%8A%A4%ED%83%9D-%EA%B0%9C%EA%B4%80-ea47917c8442" target="_blank" rel="noopener">https://engineering.huiseoul.com/%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8%EB%8A%94-%EC%96%B4%EB%96%BB%EA%B2%8C-%EC%9E%91%EB%8F%99%ED%95%98%EB%8A%94%EA%B0%80-%EC%97%94%EC%A7%84-%EB%9F%B0%ED%83%80%EC%9E%84-%EC%BD%9C%EC%8A%A4%ED%83%9D-%EA%B0%9C%EA%B4%80-ea47917c8442</a></p>
<p>Node.js교과서 도서</p>
<p><img src="/img/2019-04-11-javascript-01.png" alt=""></p>
<h3 id="호출-스택-Call-Stack"><a href="#호출-스택-Call-Stack" class="headerlink" title="호출 스택(Call Stack)"></a>호출 스택(Call Stack)</h3><p>자바스크립트는 한 개의 호출 스택만 가지고 (한번에 한 작업만 처리하는) 싱글 쓰레드 언어이다. </p>
<p>호출 스택은 우리가 프로그램 상에서 어디있는지 기록하는 자료구조로,<br>어떤 함수를 실행하면 해당 함수는 호출 스택의 가장 상단에 위치하게 되고<br>함수의 실행이 끝나면 호출 스택에서 해당 함수를 제거한다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">multiply</span>(<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x * y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printSquare</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> s = multiply(x, x);</span><br><span class="line">    <span class="built_in">console</span>.log(s);</span><br><span class="line">&#125;</span><br><span class="line">printSquare(<span class="number">5</span>);</span><br></pre></td></tr></table></figure>

<p><img src="/img/2019-04-11-javascript-02.png" alt=""></p>
<p>호출의 각 단계를 스택 프레임(Stack Frame) 이라고 한다. </p>
<p>그리고 이것은 예외가 발생했을 때 스택 트레이스(Stack Traces)가 만들어지는 방식이다. 스택 트레이스란 기본적으로 예외가 발생 했을 때 호출 스택의 상태이다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'SessionStack will help you resolve crashes :)'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    foo();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">start</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    bar();</span><br><span class="line">&#125;</span><br><span class="line">start();</span><br></pre></td></tr></table></figure>

<p>위 코드가 foo.js에 있다고 하고 크롬에서 실행을 하면 아래와 같은 스택트레이스가 만들어 진다.</p>
<p><img src="/img/2019-04-11-javascript-03.png" alt=""></p>
<p><strong>Blowing the stack (스택 날림)</strong> 은 호출 스택이 최대 크기에 다다랐을 때 나타나는데, 이런 현상은 보통 재귀 함수를 면밀히 테스트 하지 않은 경우 일어난다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function foo() &#123;</span><br><span class="line">    foo();</span><br><span class="line">&#125;</span><br><span class="line">foo();</span><br></pre></td></tr></table></figure>

<p><img src="/img/2019-04-11-javascript-04.png" alt=""></p>
<p><img src="/img/2019-04-11-javascript-05.png" alt=""></p>
<p>싱글 쓰레드를 기반으로 코딩하는 것은 어찌보면 쉬울 수 있다. 데드락(deadlocks)같은 멀티쓰레드 기반 환경에서 대처해야 되는 상황을 신경쓰지 않아도 되기 때문이다.</p>
<p>하지만 단일 쓰레드는 제한점도 많다. 특정 코드 실행이 늦어지면…?</p>
<h3 id="동시성과-이벤트-루프"><a href="#동시성과-이벤트-루프" class="headerlink" title="동시성과 이벤트 루프"></a>동시성과 이벤트 루프</h3><p>콜스택에 수행할 함수가 있으면브라우저는 아무것도 할 수 없다는게 문제다. 바로 ‘블록킹’ 되기 때문이다. 브라우저는 렌더링을 할 수도 없고 다른 코드를 수행할 수도 없다.</p>
<p>문제는또 있는데 브라우저가 호출 스택 내의 많은 작업을 수행하면서 꽤 긴시간 응답이 없으면 대부분의 브라우저에서 에러를 일으키고 사용자에게 해당 페이지를 닫을지 물어보는 상황이 발생한다.</p>
<p>그렇다면  어떻게 하면 페이지 렌더링 동작을 방해하지 않고 브라우 저의응답도 끊기지 않으면서 연산량이 많은코드를 실행할 수 있을까? 정답은 <strong>비동기 콜백(asynchronous callbacks)</strong>이다.</p>
</div></article></div></main><footer><div class="paginator"><a class="prev" href="/2019/04/11/2019-04-11-ES6-Promise/">prev</a><a class="next" href="/2019/04/10/2019-04-10-Javascript-performance/">next</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'youmekko';
var disqus_identifier = '2019/04/11/2019-04-11-Javascript-callstack/';
var disqus_title = 'Javascript 호출 스택(=Call Stack)';
var disqus_url = 'http://yoursite.com/2019/04/11/2019-04-11-Javascript-callstack/';
(function () {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//#{theme.disqus}.disqus.com/count.js" async></script><div class="copyright"><p>&copy; 2016 - 2020 <a href="https://www.example.org/john-doe" target="_blank" rel="noopener">John Doe</a>.<br>Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a href="https://github.com/Dreyer/hexo-theme-artemis" target="_blank">Artemis</a>.</p></div></footer></div></body></html>