<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title>OracleSQL(9) CONSTRAINT | Youmekko</title><meta name="description" content="OracleSQL(9) CONSTRAINT - Youme Choi"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/theme.css"><link rel="search" type="application/opensearchdescription+xml" href="/atom.xml" title="Youmekko"><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="Youmekko" type="application/atom+xml">
</head><body><div class="wrap"><header><h1 class="branding"><a href="/" title="Youmekko">Youmekko</a></h1><ul class="nav nav-list"><li class="nav-list-item"><a class="nav-list-link" href="/" target="_self">HOME</a></li><li class="nav-list-item"><a class="nav-list-link" href="/archives" target="_self">ARCHIVES</a></li><li class="nav-list-item"><a class="nav-list-link" href="https://github.com/youmekko" target="_blank">GITHUB</a></li><li class="nav-list-item"><a class="nav-list-link" href="/atom.xml" target="_self">RSS</a></li><li class="nav-list-item"><a class="nav-list-link" href="/about" target="_self">ABOUT</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">OracleSQL(9) CONSTRAINT</h1><div class="post-info"><a></a>2018-02-01</div><div class="post-content"><h3 id="7장-Constraint"><a href="#7장-Constraint" class="headerlink" title="7장. Constraint"></a>7장. Constraint</h3><ul>
<li>제약 조건(constraint)란 테이블에 올바른 데이터만 입력 받고 잘못된 데이터는 들어오지 못하도록 컬럼마다 정하는 규칙을 의미한다. 예를 들어, 학생 테이블의 학번 컬럼에는 중복된 한벅은 입력이 안되게 한다던지…</li>
<li>그래서 데이터의 정확성과 무결성을 더 높일 수 있고 이런 효과로 데이터를 더 신뢰할 수 있도록 만들어준다.</li>
<li>하나의 테이블에 설정되는 종류도 있고 2개의 테이블에 연결 되어 설정되는 종류도 있다.</li>
</ul>
<ol>
<li><p>제약 조건의 종류</p>
<ul>
<li>(1) <strong>NOT NULL</strong> : 이 조건건이 설정된 컬럼에는 NULL 값이 입력이 되지 못하도록 한다.</li>
<li>(2) <strong>UNIQUE</strong> : 이 조건이 설정된 컬럼에는 중복된 값이 입력되지 못하도록 한다.</li>
<li>(3) <strong>PRIMARY KEY</strong> : 이 조건은 NOT NULL + UNIQUE 의 특징을 가지며 테이블 내에서 데이터들끼리의 유일성을 보장하는 컬럼에 설정한다. 테이블 당 1개만 설정할 수 있다.</li>
<li>(4) <strong>FOREIGN KEY</strong> : 이 조건은 다른 테이블의 컬럼을 참조해서 검사를 한다.</li>
<li>(5) <strong>CHECK</strong> : 이 조건에 설정된 값만 입력을 허용하고 나머지는 거부된다.</li>
<li>제약 조건들은 테이블에서 컬럼별로 설정하며 PRIMARY KEY 를 제외한 나머지 제약 조건들은 하나의 제약 조건이 여러 컬럼에 중복 설정될 수 있고, 또 하나의 컬럼에 여러개의 제약 조건들이 중복으로 설정 될 수 있다.</li>
<li>PRIMARY KEY 와 UNIQUE 제약 조건이 설정된다는 의미는 해당 컬럼에 있는 데이터는 서로 중복이 되지 않는다는 뜻이다.</li>
<li>이 조건들이 설정되면 오라클은 자동으로 해당 컬럼에 UNIQUE INDEX를 생성해서 관리하게 된다. </li>
<li>그런데 이렇게 인덱스를 생성하는 작업으로 인해, 운영중인 테이블에 제약조건이 설정되는 시간이나 부하가 심할 수도 있다는 점을 꼭 기억해야 한다.</li>
<li>5가지 중에 FOREIGN KEY를 제외한 나머지 4개는 하나의 테이블에 설정이 되지만 FROREGN KEY는 두 개의 테이블을 서로 참조하도록 설정이 되며 용어나 설정 방법이 다소 복잡하다.</li>
<li>자식 테이블에 데이터가 입력되기 전에 사용자가 입력한 값이 부모테이블에 있는지를 먼저 조사한 후 해당 데이터가 있을 경우 입력이 허가되는 형태이다. 이 말은 만약 부모테이블에 데이터가 10억건이 있다면 자식 테이블에서 데이터를 1건 입력하기 위해 부모 테이블에 있는 10억건의 데이터를 전부 읽어서 검사한 후에 작업할 수 있다는 뜻이다.</li>
<li>반대로 부모테이블에 있는 데이터를 변경하거나 삭제하려면 해당 부모 테이블의 데이터를 참조하는 자식 테이블의 데이터가 없어야 한다. 그래서 부모 테이블의 데이터를 변경,삭제하려면 자식 테이블에가서 해당 데이터가 있는지 없는지 찾아봐야 하는 비효율적인 상황이 생긴다는 뜻이다!</li>
<li>이런 나쁜 상황을 해결하기 위해 참조키 제약 조건을 설정할 떄는 자식 테이블과 부모테이블의 해당 컬럼에 반드시 적절한 인덱스를 생성해주어야 한다. 즉, 자식 테이블의 컬럼과 부모 테이블의 컬럼 모두에 적절한 인덱스가 생성되어 이써야 참조키 제약 조건의 성능이 좋아진다! (아주 중요!!!)<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> dept2</span><br><span class="line">( dcode <span class="built_in">VARCHAR2</span>(<span class="number">6</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> dept2 <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> dcode_unique <span class="keyword">UNIQUE</span>(dcode);</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>제약조건 사용하기</p>
<ul>
<li>2-1. 테이블 생성시에 지정하기<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> new_emp1</span><br><span class="line">( <span class="keyword">no</span> <span class="built_in">NUMBER</span>(<span class="number">4</span>)</span><br><span class="line"> <span class="keyword">CONSTRAINT</span> emp1_no_pk PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line"> <span class="keyword">name</span> <span class="built_in">VARCHAR2</span>(<span class="number">20</span>)</span><br><span class="line"> <span class="keyword">CONSTRAINT</span> emp1_name_nn <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"> jumin <span class="built_in">VARCHAR2</span>(<span class="number">13</span>)</span><br><span class="line"> <span class="keyword">CONSTRAINT</span> emp1_jumin_nn <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"> <span class="keyword">CONSTRAINT</span> emp1_jumin_uk <span class="keyword">UNIQUE</span>,</span><br><span class="line"> loc_code <span class="built_in">NUMBER</span>(<span class="number">1</span>)</span><br><span class="line"> <span class="keyword">CONSTRAINT</span> emp1_area_ck <span class="keyword">CHECK</span>(loc_code&lt;<span class="number">5</span>),</span><br><span class="line"> deptno <span class="built_in">VARCHAR2</span>(<span class="number">6</span>)</span><br><span class="line"> <span class="keyword">CONSTRAINT</span> emp1_deptno_fk <span class="keyword">REFERENCES</span> dept2(dcode)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> new_emp2</span><br><span class="line">( <span class="keyword">no</span> <span class="built_in">NUMBER</span>(<span class="number">4</span>) PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">  <span class="keyword">name</span> <span class="built_in">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  jumin <span class="built_in">VARCHAR</span>(<span class="number">13</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">UNIQUE</span>,</span><br><span class="line">  loc_code <span class="built_in">NUMBER</span>(<span class="number">1</span>) <span class="keyword">CHECK</span>(loc_code &lt; <span class="number">5</span>),</span><br><span class="line">  deptno <span class="built_in">VARCHAR</span>(<span class="number">6</span>) <span class="keyword">REFERENCES</span> dept2(dcode)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<ul>
<li>제약 조건을 설정하는 방법은 다양한데 위 방법과 아래 방법은 동일한 효과를 내고 차이점은 각 제약 조건의 이름을 직접 지정하느냐 안하느냐 이다.</li>
<li>뒤에서 제약조건을 비활성화 하거나 활성화하거나 삭제하는 등의 관리 작업을 하려면 해당 제약 조건의 이름을 알고 있어야 한다.</li>
<li>그래서 제약 조건을 생성할 때 위의 방법처럼 제약 조건의 이름일 직접 지정하는 것을 권장한다. 제약 조건의 종류만 적고 이름을 적지 않게 되면 오라클이 자동으로 이름을 결정하게 되는데 찾기가 불편하다.</li>
<li>위의 방법들로 설정된 제약 조건들은 딕셔너리에 저장되 있으며 데이터가 입력되기 전에 참조 된다.</li>
</ul>
</li>
<li>2-2. 테이블 생성 후에 추가하기<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> member_test </span><br><span class="line">( mno <span class="built_in">VARCHAR</span>(<span class="number">10</span>),</span><br><span class="line">  mname <span class="built_in">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">  mssn <span class="built_in">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">  mphone <span class="built_in">VARCHAR</span>(<span class="number">2</span>),</span><br><span class="line">  mscore <span class="built_in">NUMBER</span>(<span class="number">3</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<ul>
<li>ALTER TABLE ADD 명령을 사용하면 된다.<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> member_test <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> mno_unique <span class="keyword">UNIQUE</span>(mno);</span><br></pre></td></tr></table></figure></li>
<li>NULL과 NOT NULL을 변경하는 경우는 조금 다르다. NULL &lt;–&gt; NOT NULL로 변경하는 것은 컬럼에 기본 값으로 변경 되어있는 NULL을 NOT NULL로 변경하는 것이기 때문에 MODIFY 키워드를 사용해서 변경해야 한다.<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> member_test <span class="keyword">MODIFY</span> (mphone <span class="keyword">constraint</span> mphone_nn <span class="keyword">NOT</span> <span class="literal">NULL</span>);</span><br></pre></td></tr></table></figure></li>
<li>참조키 제약 조건을 설정할 때는 주의사항이 있다. 부모 테이블 쪽에서 설정된느 컬럼이 Primary Key이거나 Unique키 설정이 되어있어야 한다. 그렇지 않다면 에러가 발생한다.<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> member_test <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> mssn_fk <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span>(mssn) <span class="keyword">REFERENCES</span> dept2(dcode);</span><br></pre></td></tr></table></figure></li>
<li>만약 부모테이블의 데이터를 지우고 싶은데 FOREIGN KEY를 설정했다면 자식 테이블에서 부모 테이블의 해당 데이터를 참조하고 있기 떄문에 지울 수가 없다.</li>
<li>이런 경우를 대비해서 FOREIGN KEY를 생성할 떄 ON DELETE CASCADE 옵션을 줄 수 있다. 이 옵션은 부모테이블의 데이터가 지워지면 자식 테이블의 데이터도 함께 지우라는 의미가 된다.</li>
<li>ON DELETE SET NULL 이라는 옵션도 있는데, 이것은 부모테이블의 테이터가 지워질 경우 자식 테이블의 값을 NULL로 설정하라는 의미가 된다.<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--자식 테이블</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> c_test1(</span><br><span class="line"><span class="keyword">no</span> <span class="built_in">NUMBER</span>,</span><br><span class="line"><span class="keyword">name</span> <span class="built_in">VARCHAR2</span>(<span class="number">6</span>),</span><br><span class="line">deptno <span class="built_in">NUMBER</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">--부모테이블</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> c_test2(</span><br><span class="line"><span class="keyword">no</span> <span class="built_in">NUMBER</span>,</span><br><span class="line"><span class="keyword">name</span> <span class="built_in">VARCHAR2</span>(<span class="number">10</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">--아직 부모객체의 no 컬럼이 unique key나 primary key로 설정되어 있지 않기 때문에 에러 발생</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> c_test1 </span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> ctest1_deptno_fk <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span>(deptno)</span><br><span class="line"><span class="keyword">REFERENCES</span> c_test(<span class="keyword">no</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--부모테이블의 no 컬럼을 unique key로 설정하기</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> c_test2</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> ctest2_no_uk <span class="keyword">UNIQUE</span>(<span class="keyword">no</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--자식테이블의 deptno를 부모테이블(c_test2)의 no컬럼을 참조 받게 하기 ON DELETE CASCADE 옵션 추가하기 </span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> c_test1</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> ctest1_deptno_fk <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span>(deptno)</span><br><span class="line"><span class="keyword">REFERENCES</span> c_test2(<span class="keyword">no</span>)</span><br><span class="line"><span class="keyword">ON</span> <span class="keyword">DELETE</span> <span class="keyword">CASCADE</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> c_test2 <span class="keyword">VALUES</span> (<span class="number">10</span>, <span class="string">'AAAA'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> c_test2 <span class="keyword">VALUES</span> (<span class="number">20</span>, <span class="string">'BBBB'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> c_test2 <span class="keyword">VALUES</span> (<span class="number">30</span>, <span class="string">'CCCC'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> c_test1 <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">'AAPLE'</span>, <span class="number">10</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> c_test1 <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">'banana'</span>, <span class="number">20</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> c_test1 <span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="string">'cherry'</span>, <span class="number">30</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--ON DELETE CASCASE 테스트</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> c_test1 <span class="keyword">VALUES</span> (<span class="number">4</span>, <span class="string">'peach'</span>, <span class="number">40</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--integrity constraint (CHOI.CTEST1_DEPTNO_FK) violated - parent key not found</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--c_test1(자식객체)의 마지막 컬럼인 deptno는 c_test2(부모객체)의 no를 참조 받는데15라는 값이 없으니 에러남.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--부모테이블의 객체 지우기</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> c_test2 <span class="keyword">WHERE</span> <span class="keyword">no</span>=<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--자식객체 확인해보면 자식 객체도 지워져 있음</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> c_test1;</span><br><span class="line"></span><br><span class="line"><span class="comment">--ON DELETE SET NULL 테스트</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--자식 테이블의 foreign키(참조) 설정 drop시키기</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> c_test1 <span class="keyword">DROP</span> <span class="keyword">CONSTRAINT</span> ctest1_deptno_fk;</span><br><span class="line"></span><br><span class="line"><span class="comment">--다시 foreign key설정하기 ON DELETE SET NULL 로</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> c_test1</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> ctest1_deptno_fk <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span>(deptno)</span><br><span class="line"><span class="keyword">REFERENCES</span> c_test2(<span class="keyword">no</span>)</span><br><span class="line"><span class="keyword">ON</span> <span class="keyword">DELETE</span> <span class="keyword">SET</span> <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--부모테이블의에서 삭제하기</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> c_test2 <span class="keyword">WHERE</span> <span class="keyword">no</span>=<span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--자식 테이블에서 상태 확인하기 --deptno 20이 null로 바껴있다.</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> c_test1;</span><br><span class="line"></span><br><span class="line"><span class="comment">--만약 자식 테이블의 deptno컬럼에 not null 속성이 설정되어 있다면?</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> c_test1</span><br><span class="line"><span class="keyword">MODIFY</span> (deptno <span class="keyword">CONSTRAINT</span> ctest1_deptno_nn <span class="keyword">NOT</span> <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--기존에 null 값이 있어서 변경할 수 없다.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--자식 테이블의 deptno를 30으로 바꾸기, no가 2일때</span></span><br><span class="line"><span class="keyword">UPDATE</span> c_test1 <span class="keyword">SET</span> deptno =<span class="number">30</span></span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">no</span> = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> c_test1 </span><br><span class="line"><span class="keyword">MODIFY</span>(deptno <span class="keyword">CONSTRAINT</span> ctest1_deptno_nn <span class="keyword">NOT</span> <span class="literal">NULL</span>);</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> c_test1;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
</li>
<li><p><del>제약조건 관리하기</del></p>
<ul>
<li><p><del>3-1. 제약 조건 DISALBE 하기</del></p>
</li>
<li><p><del>3-2. 제약 조건 ENABLE 하기</del></p>
</li>
<li><p><del>3-3. EXCEPTIONS 테이블을 사용하여 ENABLE VALIDATE 하기 - SYS 계정 사용</del></p>
</li>
<li><p><del>3-4. EXCEPTIONS 테이블을 사용하여 ENABLE VALIDATE - scott 계정 사용</del></p>
</li>
<li><p>3-5. 제약조건 조회하기</p>
<ul>
<li><p>테이블에 제약조건을 설정하면 그 내용이 딕셔너리에 저장이 되어있다. 사용하는 딕셔너리를 USER_CONSTRAINTS 와 USER_CONS_COULUMNS이며 –데이터베이스 전체의 제약조건을 조회하려면 DBA_CONSTRAINTS와 DBA_CONS_COLUMNS_를 사용하면 된다.</p>
</li>
<li><p>예1) new_emp2테이블에 설정되어 있는 제약조건 조회하기</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> owner, constraint_name, constraint_type, <span class="keyword">status</span></span><br><span class="line"><span class="keyword">FROM</span> user_constraints</span><br><span class="line"><span class="keyword">WHERE</span> table_name = <span class="string">'NEW_EMP2'</span>; <span class="comment">--테이블 이름은 대문자로 치기</span></span><br></pre></td></tr></table></figure></li>
<li><p>조회 결과중 constraint_type의 값중에 P는 프라이머리 키, U는 유니크, C는 체크, R은 외래키를 의미한다.</p>
</li>
<li><p>예2) 특정 테이블의 특정 컬럼에 설정되어 있는 모든 제약 조건 보기</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> owner, constraint_name, table_name column_name</span><br><span class="line"><span class="keyword">FROM</span> user_cons_columns</span><br><span class="line"><span class="keyword">WHERE</span> table_name = <span class="string">'EMP'</span>; <span class="comment">--테이블 이름은 대문자로 치기!</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>3-6. 제약 조건 삭제하기</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> new_emp2 <span class="keyword">DROP</span> <span class="keyword">CONSTRAINT</span> emp2_name_fk;</span><br></pre></td></tr></table></figure>


</li>
</ul>
</li>
</ol>
</div></article></div></main><footer><div class="paginator"><a class="prev" href="/2018/02/01/2018-02-01-Algorithm/">prev</a><a class="next" href="/2018/02/01/2018-02-01-OracleSQL_03/">next</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'youmekko';
var disqus_identifier = '2018/02/01/2018-02-01-OracleSQL_04/';
var disqus_title = 'OracleSQL(9) CONSTRAINT';
var disqus_url = 'http://yoursite.com/2018/02/01/2018-02-01-OracleSQL_04/';
(function () {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//#{theme.disqus}.disqus.com/count.js" async></script><div class="copyright"><p>&copy; 2016 - 2020 <a href="https://www.example.org/john-doe" target="_blank" rel="noopener">John Doe</a>.<br>Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a href="https://github.com/Dreyer/hexo-theme-artemis" target="_blank">Artemis</a>.</p></div></footer></div></body></html>