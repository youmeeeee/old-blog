<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title>(구멍가게코딩단) Part1-4. SPRING + MyBatis + MySQL | Youmekko</title><meta name="description" content="(구멍가게코딩단) Part1-4. SPRING + MyBatis + MySQL - Youme Choi"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/theme.css"><link rel="search" type="application/opensearchdescription+xml" href="/atom.xml" title="Youmekko"><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="Youmekko" type="application/atom+xml">
</head><body><div class="wrap"><header><h1 class="branding"><a href="/" title="Youmekko">Youmekko</a></h1><ul class="nav nav-list"><li class="nav-list-item"><a class="nav-list-link" href="/" target="_self">HOME</a></li><li class="nav-list-item"><a class="nav-list-link" href="/archives" target="_self">ARCHIVES</a></li><li class="nav-list-item"><a class="nav-list-link" href="https://github.com/youmekko" target="_blank">GITHUB</a></li><li class="nav-list-item"><a class="nav-list-link" href="/atom.xml" target="_self">RSS</a></li><li class="nav-list-item"><a class="nav-list-link" href="/about" target="_self">ABOUT</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">(구멍가게코딩단) Part1-4. SPRING + MyBatis + MySQL</h1><div class="post-info"><a></a>2018-04-11</div><div class="post-content"><h1 id="PART-1-프로젝트의-기본-구조-구성"><a href="#PART-1-프로젝트의-기본-구조-구성" class="headerlink" title="PART 1 프로젝트의 기본 구조 구성"></a>PART 1 프로젝트의 기본 구조 구성</h1><h3 id="4-Spring-MyBatis-MySQL"><a href="#4-Spring-MyBatis-MySQL" class="headerlink" title="4. Spring + MyBatis + MySQL"></a>4. Spring + MyBatis + MySQL</h3><p>스프링을 이용한 개발 중 국내에서 가장 많이 쓰이는 형태는 MyBatis와의 연동 작업을 통해서 SQL 처리에 대한  개발 생산성을 높이는 형태이다. <del>이 책은 초판은 인쇄는 2015년 8월이다. 그리 오래되지 않았으니 아직은 믿을 만한 내용인것 같지만, 일단 이 부분 검색해서 확인하자.</del></p>
<p>위 형태로 개발하기 위해서 해야할 작업은 아래와 같다.</p>
<ul>
<li>스프링과 MyBatis를 연동하기 위한 라이브러리 설정</li>
<li>데이터베이스와의 연결을 담당하는 DataSource 객체 설정</li>
<li>MyBatis의 핵심인 SqlSessionFactory 객체 설정 및 테스트</li>
</ul>
<h4 id="일반적인-스프링-웹-프로젝트의-구성"><a href="#일반적인-스프링-웹-프로젝트의-구성" class="headerlink" title="일반적인 스프링 웹 프로젝트의 구성"></a>일반적인 스프링 웹 프로젝트의 구성</h4><p>일반적으로 웹 프로젝트는 3개의 레이어(혹은 tier)로 구성한다.</p>
<p><img src="/img/2018-04-11-spring-03.png" alt=""></p>
<ul>
<li><p>Presentation Layer - UI를 담당하는 구성 요소들이 들어간다. 웹인지 모바일인지에 따라 사용되는 기술이 변경된다.</p>
</li>
<li><p>Business Logic Layer - 서비스 계층이라고도 하며, 고객의 요구사항을 반영하는 계층이다. 사용자의 환경이 아닌 기능적인 요구사항을 구현하는 곳이다. 즉 비지니스 계층은 어떤 형태의 데이터가 필요하고 반환될 것인지를 결정한다.</p>
</li>
<li><p>Data Access Layer - 흔히 Persistence Layer라고 하는데, 데이터 처리를 담당한다.</p>
</li>
</ul>
<h4 id="교재의-예제-프로젝트-구성"><a href="#교재의-예제-프로젝트-구성" class="headerlink" title="교재의 예제 프로젝트 구성"></a>교재의 예제 프로젝트 구성</h4><p><img src="/img/2018-04-11-spring-04.png" alt=""></p>
<p>Presentation Layer의 경우는 JSP와 같은 View를 구성하는 부분과 Controller라는 부분으로 분리되어 작성한다. Data Access Layer의 경우는 MyBatis가 추가 된다. Data Layer Access를 구성하는 DAO의 경우 MyBatis를 호출하고 사용하는 구조로 만들어진다.</p>
<h4 id="MyBatis연동"><a href="#MyBatis연동" class="headerlink" title="MyBatis연동"></a>MyBatis연동</h4><p>스프링은 다양한 프레임워크와의 융합에 그 장점이 있다. 스프링을 중심으로 하고 다양한 프레임워크를 융합해서 사용할 수 있기 때문에 다양한 기존 환경을 그대로 흡수할 수 있따는 장점도 있다. </p>
<p>스프링은 다른 프레임워크와읭 연동 작업을 위한 별도의 하위 모듈을 많이 가지고 있는데 이 파트에서 사용할 모듈은 spring-jdbc와 spring-test 모듈이다.</p>
<p>spring-jdbc모듈은 스프링이 그 자체로 가지고 있는 JDBC 모듈로 이 자체만 이용해서 개발할 수 있지만, MyBatis만큼 개발의 편리함을 제공하지는 못한다.</p>
<ul>
<li>간결한 코드의 처리</li>
</ul>
<p>MyBatis는 통상 SQL Mapper라는 라이브러리이다. try ~ catch ~ finally / PreparedStatement / ResultSet 같은 코드를 상당히 많이 줄여줄 수 있다. (오! 신세계!) 스프링과 MyBatis를 결합하게 되면 코드 제작 없이도 JDBC의 처리가 가능하게 된다.</p>
<ul>
<li>SQL문의 분리 운영</li>
</ul>
<p>JDBC는 SQL문을 처리하기 위해서 별도의 파일을 작성하는 등의 번거로운 작업이 필요하지만, MyBatis의 경우에는 XML 혹은 애노테이션 방식으로 SQL 문을 별도로 처리하는 작업이 가능하고 필요한 경우에는 두가지 방식을 혼합해서 사용하는 것도 가능하다.</p>
<ul>
<li>Spring과의 연동으로 자동화된 처리</li>
</ul>
<p>MyBatis - Spring 라이브러리를 이용하면 개발자는 직접 SQL 문의 호출 없이도 원하는 결과를 얻을 수 있다. 코드의 양을 줄여준다.</p>
<ul>
<li>동적 SQL을 이용한 제어 기능</li>
</ul>
<p>MyBatis는 기본적으로 SQL문을 처리하긴 하지만, 약간의 제어문이나 루프 등의 처리 기능을 가지고 있다. 이를 통해 SQL 관련된 처리를 Java코드에서 분리시킬 수 있다.</p>
<h3 id="1-spring-jdbc-spring-test-MyBatis-mybatis-spring-추가"><a href="#1-spring-jdbc-spring-test-MyBatis-mybatis-spring-추가" class="headerlink" title="1) spring-jdbc, spring-test, MyBatis, mybatis-spring 추가"></a>1) spring-jdbc, spring-test, MyBatis, mybatis-spring 추가</h3><p>(1) pom.xml을 이용해서 필요한 jar 파일들을 다운로드</p>
<p>Spring과 MyBatis 사이에는  두 프레임워크 접착체 역할을 하는 MyBatis - Spring 모듈이 필요하다. 이를 위해서 pom.xml에 다음과 같은 프레임 워크 라이브러리를 추가한다.</p>
<ul>
<li>MyBatis</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.4.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>MyBatis-Spring</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>spring-jdbc</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;org.springframework-version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>spring-test</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;org.springframework-version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>spring-test는 스프링과 MyBatis가 정상적으로 연동되었는지를 확인하는 용도로 사용한다. 이후의 예제에서 필요하지 않다면 WAS의 구동없이 정상적으로 동작하는지를 확인하는 용도로 사용한다. 위 설정을 pom.xml에 추가하고 저장해서 라이브러리가 다운로드 되는것을 확인한다. 추가한 라이브러리가 정상적으로 다운로드 되었다면 root-context.xml에서 조금 더 다양한 태그를 사용할 수 있다.</p>
<p>(2) 스프링 설정 파일을 수정</p>
<p>프로젝트 내에 src/main/webapp/WEB-INF/spring/root-context.xml 파일은 STS가 스프링 프로젝트를 생성할 때 만들어주는 파일에서 가장 중요한 파일이다. 이 파일은 스프링과 관련된 설정을 할 때, 쉽게 말해 웹 자원과 관련되지 않은 모든 설정을 위해서 존재한다. (웹과 관련된 설정은 appServlet 폴더 내에 있는 servlet-context.xml파일로 분리한다.)</p>
<p>root-context.xm 파일에 스프링 프레임워크에 다양한 설정을 하기 위해서는 STS상에서 Namespaces 탭을 이용해 사용 가능한 XML태그의 폭을 넓혀줘야 한다. (XML 네임스페이스는 간단히 말하면 XML 문서내에 어떤 태그나 속성을 적을 수 있는지 명시해주는 역할을 한다.)</p>
<p><img src="/img/2018-04-11-spring-05.png" alt=""></p>
<p><img src="/img/2018-04-11-spring-06.png" alt=""></p>
<h3 id="2-MySQL과의-연결을-담당하는-DataSource-설정하기"><a href="#2-MySQL과의-연결을-담당하는-DataSource-설정하기" class="headerlink" title="2) MySQL과의 연결을 담당하는 DataSource 설정하기"></a>2) MySQL과의 연결을 담당하는 DataSource 설정하기</h3><p>스프링과 MyBatis를 같이 사용하는 경우에는 주로 스프링의 설정으로 JDBC연결을 처리하는 경우가 많기 때문에 조금 전에 추가한 spring-jdbc 모듈의 클래스를 이용해서 root-context.xml에 다음과 같이 DataSource라는 것을 추가한다.</p>
<p>DataSource는 JDBC의 커넥션을 처리하는 기능을 가지고 있기 때문에 데이터베이스와 연동 작업에 반드시 필요하다.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span></span></span><br><span class="line"><span class="tag">			<span class="attr">value</span>=<span class="string">"jdbc:mysql://211.00.00.00:3306/schema?useSSL=false"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"username"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"password"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>id라는 속성은 스프링 내에서 특정한 객체(빈)을 찾기 위해서 사용하는 일종의 가명(alias)에 속한다. </p>
<ul>
<li>DataSource의 테스트 진행</li>
</ul>
<p>스프링은 하나의 설정에 문제가 있다면 정상적으로 로딩이 되지 않기 때문에 최대한 빨리 변경된 설정에 대해서 테스트를 해야한다. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.zerock.web;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.inject.Inject;</span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.ContextConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</span><br><span class="line"></span><br><span class="line">     <span class="comment">//현재 테스트 코드를 실행할 때 스프링이 로딩 되도록 하는 부분.</span></span><br><span class="line">	<span class="meta">@RunWith</span>(SpringJUnit4ClassRunner<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">	//속성 경로에 <span class="title">xml</span>파일을 이용해 스프링이 로딩 된다.</span></span><br><span class="line"><span class="class">	@<span class="title">ContextConfiguration</span>(</span></span><br><span class="line"><span class="class">			<span class="title">locations</span> </span>=&#123;<span class="string">"file:src/main/webapp/WEB-INF/spring/**/root-context.xml"</span>&#125;)</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DataSourceTest</span></span>&#123;</span><br><span class="line">		<span class="comment">//스프링이 생성해서 주입해준다.</span></span><br><span class="line">		<span class="meta">@Inject</span></span><br><span class="line">		<span class="keyword">private</span> DataSource ds;</span><br><span class="line">		</span><br><span class="line">		<span class="meta">@Test</span></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testConnection</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">try</span>(Connection con = ds.getConnection())&#123;</span><br><span class="line">			   System.out.println(con);</span><br><span class="line">			&#125;<span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;		</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>JUnit 테스트를 해서 위 코드가 정상적으로 실행된다면 스프링이 로딩될 때의 로그들과 Connection 객체가 생성되었다는 것을 확인 할 수 있다.</p>
<p><img src="/img/2018-04-11-spring-07.png" alt=""></p>
<h3 id="3-MyBatis-연결"><a href="#3-MyBatis-연결" class="headerlink" title="3) MyBatis 연결"></a>3) MyBatis 연결</h3><p>DataSource가 정상적으로 설정되면( <u>스프링은 한개의 설정이 잘못되는 경우 실행 자체에 문제가 생기므로 하나씩 설정하고 테스트 하는 습관을 가져야 한다.</u>) MyBatis와 MySQL을 연동해야 한다.</p>
<ul>
<li>SqlSessionFactory 객체 설정</li>
</ul>
<p>MyBatis와 스프링 연동 작업에서의 핵심을 Connection을 생성하고, 처리하는 SqlSesiionFactory의 존재인다. SqlSesiionFactory는 데이터베이스와의 연결과 SQL 실행에 대한 모든 것을 가진 가장 중요한 객체이다.</p>
<p>스프링을 이용할 때는 SqlSesiionFactory를 생성해주는 특별한 객체를 설정해주는데 SqlSesiionFactoryBean이라는 클래스를 사용한다. SqlSesiionFactory은 프로젝트의 root-context.xml에 등록한다.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSesiionFactoryBean"</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>추가된 객체(빈)의 class 속성값은 ‘org.mybatis.spring.xxx’ 클래스이다. 이 클래스는 MyBatis-Spring 모듈을 다운로드 받아야 사용할 수 있다.</p>
<ul>
<li>mybatis-config.xml 파일의 추가</li>
</ul>
<p>MyBatis는 SQL Mapping 프레임워크로 별도의 설정 파일을 가질 수 있다. src/main/resources 내에 mybatis-config.xml 파일을 생성해두자. 만들어진 파일을  편하게 사용하기 위해서는 XML 파일의 DTD나 XML 스키마라는 것이 필요하다. ‘mybatis config dtd’라는 키워드로 검색하면 만들어진 파일의 상단에 들어갈 DTD라는 것을 찾을수 있다. </p>
<p>자세한 내용은 <a href="http://www.mybatis.org/mybatis-3/ko/getting-started.html" target="_blank" rel="noopener">여기</a>에서 확인하기.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta"> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta"> <span class="meta-string">"http://mybatis.org//dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-MyBatis-연결-테스트"><a href="#4-MyBatis-연결-테스트" class="headerlink" title="4) MyBatis 연결 테스트"></a>4) MyBatis 연결 테스트</h3><p>모든 설정이 완료 되었다면 마지막에는 정상적으로 스프링에서 MyBatis와 MySQL까지의 모든 연결이 제대로 되었는지를 확인해본다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.zerock.web;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.inject.Inject;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.ContextConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</span><br><span class="line"><span class="comment">//현재 테스트 코드를 실행할 때 스프링이 로딩 되도록 하는 부분.</span></span><br><span class="line"><span class="meta">@RunWith</span>(SpringJUnit4ClassRunner<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">//속성 경로에 <span class="title">xml</span>파일을 이용해 스프링이 로딩 된다.</span></span><br><span class="line"><span class="class">@<span class="title">ContextConfiguration</span>(<span class="title">locations</span> </span>= &#123; <span class="string">"file:src/main/webapp/WEB-INF/spring/**/root-context.xml"</span> &#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBatisTest</span> </span>&#123;</span><br><span class="line">    <span class="comment">//위에서 스프링이 정상적으로 동작할 경우 스프링이 생성해서 주입해준다.</span></span><br><span class="line">    <span class="comment">//root-context.xml 파일에서 설정한 SqlSesiionFactoryBean설정에 문제가 있었다면 이 코드에서 에러가 발생한다.</span></span><br><span class="line">	<span class="meta">@Inject</span></span><br><span class="line">	<span class="keyword">private</span> SqlSessionFactory sqlFactory;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFactory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(sqlFactory);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">tesSession</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> (SqlSession session = sqlFactory.openSession()) &#123;</span><br><span class="line">			System.out.println();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>성공하면 아래와 같은 메세지가 보여진다.</p>
<p><img src="/img/2018-04-11-spring-08.png" alt=""></p>
<h4 id="작업-내역의-정리"><a href="#작업-내역의-정리" class="headerlink" title="작업 내역의 정리"></a>작업 내역의 정리</h4><ul>
<li>필요한 라이브러리 추가</li>
<li>MyBatis, MyBatis-Spring, spring-jdbc, spring-test 모듈 추가</li>
<li>DataSource 객체의 설정과 테스트</li>
<li>MyBatis의 SqlSessionFactoryBean의 설정</li>
<li>MyBatis의 설정 파일인 mybatis-config.xml 파일의 설정</li>
<li>Spring + MyBatis + MySQL의 최종 연결 테스트</li>
</ul>
<h1 id="테스트-코드를-작성하는데-소홀하지-말자-테스트-하는-습관은-나중에-유지보수를-진행하거나-개별적인-코드를-하나로-통합하는-과정에서-그-위력이-드러난다"><a href="#테스트-코드를-작성하는데-소홀하지-말자-테스트-하는-습관은-나중에-유지보수를-진행하거나-개별적인-코드를-하나로-통합하는-과정에서-그-위력이-드러난다" class="headerlink" title="테스트 코드를 작성하는데 소홀하지 말자! 테스트 하는 습관은 나중에 유지보수를 진행하거나 개별적인 코드를 하나로 통합하는 과정에서 그 위력이 드러난다!!!"></a>테스트 코드를 작성하는데 소홀하지 말자! 테스트 하는 습관은 나중에 유지보수를 진행하거나 개별적인 코드를 하나로 통합하는 과정에서 그 위력이 드러난다!!!</h1></div></article></div></main><footer><div class="paginator"><a class="prev" href="/2018/04/11/2018-04-11-Algorithm/">prev</a><a class="next" href="/2018/04/11/2018-04-11-Spring-02/">next</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'youmekko';
var disqus_identifier = '2018/04/11/2018-04-11-Spring-03/';
var disqus_title = '(구멍가게코딩단) Part1-4. SPRING + MyBatis + MySQL';
var disqus_url = 'http://yoursite.com/2018/04/11/2018-04-11-Spring-03/';
(function () {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//#{theme.disqus}.disqus.com/count.js" async></script><div class="copyright"><p>&copy; 2016 - 2020 <a href="https://www.example.org/john-doe" target="_blank" rel="noopener">John Doe</a>.<br>Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a href="https://github.com/Dreyer/hexo-theme-artemis" target="_blank">Artemis</a>.</p></div></footer></div></body></html>